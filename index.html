<!DOCTYPE html>
<html id="ng-app" ng-app="BangumiList">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge, chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <title>番组放送</title>
        <link type="text/css" rel="stylesheet" href="css/main.css">
        <link type="text/css" rel="stylesheet" href="css/ngprogress-lite.css">
        <!--[if lte IE 7]><script type="text/javascript" src="js/json2.js"></script><![endif]-->
    </head>
    <body ng-controller="ListController" ng-cloak>
        <noscript>
            <img src="images/no-js.gif" alt="没有打开Javascript！">
            <p style="text-align:center;">请打开javascript支持以显示本页面</p>
        </noscript>
        <div id="topbar">
            <ul id=topnav>
                <li class="title">
                    <a href="http://bgmlist.com/">番组放送</a>
                </li>
                <li class="menu">
                    <a href="javascript:;">历史数据</a>
                    <ul class="submenu year">
                        <li ng-repeat="file in archive">
                            {{file.year}}年
                            <ul class="submenu month">
                                <li ng-repeat="data in file.months" 
                                    ng-click="readBangumi(getJsonPath(file.year, data.month, archive),'jp',false);query.weekDayCN=undefined">
                                    {{data.month | monthCN}}</li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="menu">
                    <a href="javascript:;">显示设置</a>
                    <ul class="submenu display">
                        <li>
                            <label for="newOnly">只显示新番
                                <span ng-class="{'toggleON':query.newBgm,'toggleOFF':!query.newBgm}"></span>
                            </label>
                            <input type="checkbox" name="newOnly" id="newOnly" 
                            ng-model="query.newBgm" ng-false-value="" 
                            ng-change="ipCookie('newOnly',query.newBgm,{expires:365})">
                        </li>
                        <li>
                            <label for="outOnly">只显示已开播番组
                                <span class="toggleOFF"></span>
                            </label>
                            <input type="checkbox" name="outOnly" id="outOnly">
                        </li>
                    </ul>
                </li>
                <li class="menu">
                    <a href="javascript:;">站点过滤</a>
                    <ul class="submenu sites">
                        <li ng-repeat="airSite in siteList">
                            <label for="{{airSite.domain}}">{{airSite.name}}
                                <span class="toggleON" 
                                    ng-class="{'toggleON':airSite.show,'toggleOFF':!airSite.show}">
                                </span>
                            </label>
                            <input type="checkbox" name="{{airSite.domain}}" id="{{airSite.domain}}" 
                                ng-model="airSite.show" 
                                ng-change="ipCookie(airSite.domain,airSite.show,{expires:365})">
                        </li>
                        <li><span class="selectAll">全选</span></li>
                    </ul> 
                </li>
                <li class="share twitter">
                    <a href="https://twitter.com/share?url=http%3A%2F%2Fbgmlist.com%2F&text=%e6%96%b9%e4%be%bf%e5%bf%ab%e6%8d%b7%e7%9a%84%e6%ad%a3%e7%89%88%e6%96%b0%e7%95%aa%e6%94%be%e9%80%81%e8%81%9a%e5%90%88%e7%ab%99+-+%e7%95%aa%e7%bb%84%e6%94%be%e9%80%81" title="分享到Twitter" target="_blank">分享到Twitter</a>
                </li>
                <li class="share weibo">
                    <a href="http://service.weibo.com/share/share.php?title=%e6%96%b9%e4%be%bf%e5%bf%ab%e6%8d%b7%e7%9a%84%e6%ad%a3%e7%89%88%e6%96%b0%e7%95%aa%e6%94%be%e9%80%81%e8%81%9a%e5%90%88%e7%ab%99+-+%e7%95%aa%e7%bb%84%e6%94%be%e9%80%81&url=http%3A%2F%2Fbgmlist.com%2F" title="分享到微博" target="_blank">分享到微博</a>
                </li>
                <li class="share plain">
                    分享
                </li>

            </ul>
        </div>
        <h1>{{yearRead}}年{{monthRead}}月番组</h1>
        <div id="nav">
            <ul id='switcher'>
                <li ng-repeat="nav in navList" 
                    ng-class="{'selected':$parent.query.weekDayCN===nav.index}" 
                    class-fix ng-click="$parent.query.titleCN='';$parent.query.weekDayCN=nav.index;
                    order(bangumis,nav.order,false);">{{nav.name}}</li>
            </ul> 
            <div id="search">
                <input type="text" ng-model="query.titleCN" 
                placeholder="搜索本月番组" ng-keydown="query.weekDayCN=undefined">
            </div>
        </div>
        <div id="container">
            <table>
                <colgroup>
                    <col id="name">
                    <col id="time-jp">
                    <col id="time-cn">
                    <col id="site">
                </colgroup>
                <thead>
                    <tr>
                        <th>作品名</th>
                        <th>
                            <span ng-click="order(bangumis,'jp',reversed)" 
                                ng-class="{'ordered':ordered==='jp'}" class-fix>日本放送时间</span>
                        </th>
                        <th>
                            <span ng-click="order(bangumis,'cn',reversed)" 
                                ng-class="{'ordered':ordered==='cn'}" class-fix>大陆放送时间</span>
                        </th>
                        <th>播放网址</th>
                    </tr>
                </thead>
                <tbody id="bangumi_list">
                    <tr ng-repeat="item in bangumis | filter:query track by $index" 
                        ng-class-even="'color'" class-fix>
                        <td>
                            <a href="{{item.officalSite}}" ng-class="{'new':item.newBgm}" class-fix>
                                {{item.titleCN}}<span span-fix>{{item.titleJP}}</span></a>
                        </td>
                        <td>{{item.weekDayJP | weekday}}&#160;&#160;{{item.timeJP | time}}</td>
                        <td>{{item.weekDayCN | weekday}}&#160;&#160;{{item.timeCN | time}}</td>
                        <td>
                            <ul class="link-list">
                                <li ng-repeat="site in item.onAirSite | linkFilter:siteList" 
                                    ng-class="{'lastLink':$last}">
                                    <a href="{{site}}">{{site | onair}}</a></li>
                            </ul>    
                            <p ng-show="item.onAirSite.length===0" style="color:gray" class-fix>暂无</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p id="footer">&copy; 
            <a href="http://bgmlist.com/">番组放送</a> | All Rights Reserved | Powered by 
            <a href="https://angularjs.org/">AngularJS</a>
            and <a href="https://github.com/wxt2005/new_bangumi/">GitHub</a>
        </p>
        <script type="text/javascript" src="js/angular.min.js"></script> 
        <script type="text/javascript" src="js/angular-cookie.min.js"></script> 
        <script type="text/javascript" src="js/app.js"></script> 
        <script type="text/javascript" src="js/iefix.js"></script> 
        <script type="text/javascript" src="js/ngprogress-lite.min.js"></script> 
    </body>
</html>
