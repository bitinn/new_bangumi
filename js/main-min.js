var weekDayList=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];if(typeof Array.prototype.indexOf!=="function"){Array.prototype.indexOf=function(c){for(var b=0,a=this.length;b<a;b++){if(this[b]===c){return b}}return -1}}function selectButton(b,d){for(var c=0,a=b.length;c<a;c++){if(c===d){b[c].className="selected"}else{b[c].className=""}}}function colorTable(a){var d=true;for(var c=0,b=a.length;c<b;c++){if(a[c].className!=="hide"){if(!d){a[c].className="color"}d=!d}}}function hideOtherBangumi(a,d){if(d===-1){for(var e=0,b=a.length;e<b;e++){a[e].className=""}}else{for(var e=0,b=a.length;e<b;e++){var h=a[e].getElementsByTagName("td"),g=h[1].textContent||h[1].innerText,f=h[2].textContent||h[2].innerText,c=weekDayList[d];if((f.indexOf("N/A")===-1&&f.indexOf(c)===-1)||(f.indexOf("N/A")!==-1&&g.indexOf(c)===-1)){a[e].className="hide"}else{a[e].className=""}}}colorTable(a)}function bindButton(a,b,c){b.onclick=function(g){var g=g||window.event,h=g.target||g.srcElement,f=[1,2,3,4,5,6,0,-1];for(var e=0,d=c.length;e<d;e++){if(c[e]===h){hideOtherBangumi(a,f[e]);selectButton(c,e)}}}}function disableIeSpan(a){if(navigator.appName==="Microsoft Internet Explorer"&&+navigator.appVersion.match(/MSIE\s(\d+)/)[1]<9){for(var c=0,b=a.length;c<b;c++){var d=a[c].getElementsByTagName("span")[0];d.style.cssText="display:none"}}}function showTable(b){if(navigator.appName==="Microsoft Internet Explorer"&&+navigator.appVersion.match(/MSIE\s(\d+)/)[1]<10){var c=document.getElementsByTagName("tbody")[0],a=c.ownerDocument.createElement("div");a.innerHTML="<table><tbody id='bangumi_list'>"+b+"</tbody></table>";c.parentNode.replaceChild(a.firstChild.firstChild,c)}else{document.getElementById("bangumi_list").innerHTML=b}return document.getElementById("bangumi_list").getElementsByTagName("tr")}function createXHR(){if(typeof XMLHttpRequest!=="undefined"){return new XMLHttpRequest()}else{if(typeof ActiveXObject!=="undefined"){return new ActiveXObject("Microsoft.XMLHTTP")}else{throw new Error("No XHR object available.")}}}function buildTable(c){var b=[];for(var a in c){var h="",g=c[a];h+="<tr><td><a href='"+g.officalSite+"'>"+a+"<span>"+g.originName+"</span></a></td><td>"+g.timeJP+"</td><td>"+g.timeCN+"</td><td>";if(g.onAir.length===0){h+="N/A"}else{for(var e=0,d=g.onAir.length;e<d;e++){h+="<a href='"+g.onAir[e]+"'>";var f=/^https{0,}:\/\/\w+\.(\w+)\.\w+/i;switch(g.onAir[e].match(f)[1].toLowerCase()){case"youku":h+="优酷";break;case"sohu":h+="搜狐";break;case"qq":h+="腾讯";break;case"iqiyi":h+="爱奇艺";break;case"letv":h+="乐视";break;case"pptv":h+="PPTV";break;case"tudou":h+="土豆";break;case"bilibili":h+="B站";break;case"acfun":h+="A站";break;default:h+="未知"}h+="</a> ";if(e%2!==0){h+="<br>"}}}h+="</td></tr>";b.push(h)}b.sort(function(k,i){var m=weekDayList.indexOf(k.match(/星期.{1}/)[0]),j=weekDayList.indexOf(i.match(/星期.{1}/)[0]),l=k.match(/\d{2}:\d{2}/)[0],n=i.match(/\d{2}:\d{2}/)[0];if(m===j){if(l===n){return 0}else{if(l<n){return -1}else{return 1}}}else{if(m<j){return -1}else{return 1}}});return b.join("")}function getJSON(){var a=createXHR();a.open("get","json/bangumi.json",false);a.send(null);return a.responseText}function dayToNum(a){return a!==0?num=a-1:num=6}function initPage(){var c=document.getElementById("nav");var e=c.getElementsByTagName("li");var d=new Date().getDay();var b=JSON.parse(getJSON());var a=showTable(buildTable(b));disableIeSpan(a);bindButton(a,c,e);hideOtherBangumi(a,d);selectButton(e,dayToNum(d))}window.onload=function(){initPage()};